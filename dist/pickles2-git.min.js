!function t(e,n,i){function s(r,a){if(!n[r]){if(!e[r]){var c="function"==typeof require&&require;if(!a&&c)return c(r,!0);if(o)return o(r,!0);throw new Error("Cannot find module '"+r+"'")}var l=n[r]={exports:{}};e[r][0].call(l.exports,function(t){var n=e[r][1][t];return s(n?n:t)},l,l.exports,t,e,n,i)}return n[r].exports}for(var o="function"==typeof require&&require,r=0;r<i.length;r++)s(i[r]);return s}({1:[function(t,e,n){var i={};i=function(){function t(t){var e=new Date(t),n=function(t){return("00000"+t).slice(-2)};return e.getFullYear()+"-"+n(e.getMonth()+1)+"-"+n(e.getDate())+" "+n(e.getHours())+":"+n(e.getMinutes())+":"+n(e.getSeconds())}function e(t){return"?"==t.work_tree&&"?"==t.index?"untracked":"A"==t.work_tree||"A"==t.index?"added":"M"==t.work_tree||"M"==t.index?"modified":"D"==t.work_tree||"D"==t.index?"deleted":(console.error("unknown status type;"),console.error(t),"unknown")}var n=this;this.px=px,this.pj=pj,this.git=pj.git();var i={sitemaps:{label:"サイトマップ"},contents:{label:"コンテンツ"}};this.commit=function(t,s,o){function r(t,e,i){switch(t){case"contents":n.git.statusContents([e.page_path],function(t,e,n){i(t,e,n)});break;default:n.git.status(function(t,e,n){i(t,e,n)})}}function a(t,e,i,s){switch(t){case"contents":n.git.commitContents([e.page_path,i],function(){s()});break;case"sitemaps":n.git.commitSitemap([i],function(){s()});break;default:s()}}o=o||function(){};var c=$('<div class="px2dt-git-commit">'),l=$('<ul class="list-group">'),p=$("<textarea>");return px.progress.start({blindness:!0,showProgressBar:!0}),r(t,s,function(n,r,d){if(n===!1)return alert("ERROR: "+r),px.progress.close(),void o();c.html(""),c.append($("<p>").text("branch: ").append($("<code>").text(n.branch)));var u=[];if(u="contents"==t?n.changes:n.div[t],!u.length)return alert("コミットできる変更がありません。"),px.progress.close(),void o();for(var g in u){var f=e(u[g]),x=$('<li class="list-group-item">').text("["+f+"] "+u[g].file).addClass("px2dt-git-commit__stats-"+f);l.append(x)}c.append(l),c.append(p),px.dialog({title:i[t].label+"をコミットする",body:c,buttons:[$("<button>").text("コミット").attr({type:"submit"}).addClass("px2-btn px2-btn--primary").click(function(){px.progress.start({blindness:!0,showProgressBar:!0});var e=p.val();a(t,s,e,function(){alert("コミットしました。"),px.progress.close(),px.closeDialog(),o()})}),$("<button>").text("キャンセル").addClass("px2-btn").click(function(){px.closeDialog()})]}),px.progress.close()}),this},this.log=function(e,s,o){function r(t,e,i){switch(t){case"contents":n.git.logContents([e.page_path],function(t,e,n){i(t,e,n)});break;case"sitemaps":n.git.logSitemaps(function(t,e,n){i(t,e,n)})}}function a(t,e,i,s){switch(t){case"contents":n.git.rollbackContents([e.page_path,i],function(t,e,n){s(t,e,n)});break;case"sitemaps":n.git.rollbackSitemaps([i],function(t,e,n){s(t,e,n)})}}o=o||function(){};var c=$('<div class="px2dt-git-commit">'),l=$('<ul class="list-group">');return px.progress.start({blindness:!0,showProgressBar:!0}),r(e,s,function(r,p,d){if(r===!1)return alert("ERROR: "+p),px.progress.close(),void o();c.html("");for(var u in r)!function(){var o=$('<li class="list-group-item px2dt-git-commit__loglist">'),c=$('<div class="px2dt-git-commit__loglist-row">');c.append($('<div class="px2dt-git-commit__loglist-row-date">').text(t(r[u].date))),c.append($('<div class="px2dt-git-commit__loglist-row-title">').text(r[u].title)),c.append($('<div class="px2dt-git-commit__loglist-row-name">').text(r[u].name+" <"+r[u].email+">")),c.append($('<div class="px2dt-git-commit__loglist-row-hash">').text(r[u].hash));var p=$('<div class="px2dt-git-commit__loglist-detail">').hide().attr({"data-px2dt-hash":r[u].hash}).click(function(t){t.stopPropagation()});o.click(function(){p.toggle("fast",function(){var t=$(this).attr("data-px2dt-hash");p.is(":visible")?(p.html('<div class="px2-loading"></div>'),n.git.show([t],function(n){n.length>2e3&&(n=n.substr(0,1997)+"..."),p.html("").append($("<pre>").text(n).css({"max-height":300,overflow:"auto"})).append($("<button>").addClass("px2-btn").addClass("px2-btn--primary").text("このバージョンまでロールバックする").click(function(){confirm("この操作は現在の "+i[e].label+" の変更を破棄します。よろしいですか？")&&(px.progress.start({blindness:!0,showProgressBar:!0}),a(e,s,t,function(t,e,n){t?alert("ロールバックを完了しました。"):(alert("[ERROR] ロールバックは失敗しました。"),alert(e),console.error("ERROR: "+e)),px.progress.close()}))}))})):p.html("")})}),l.append(o.append(c).append(p))}();c.append(l),px.dialog({title:i[e].label+"のコミットログ",body:c,buttons:[$("<button>").text("閉じる").attr({type:"submit"}).addClass("px2-btn px2-btn--primary").click(function(){px.closeDialog(),o()})]}),px.progress.close()}),this}},"undefined"!=typeof e&&e.declare?e.declare([],function(t,e,n){for(key in i)i.hasOwnProperty(key)&&(e[key]=i[key])}):"function"==typeof define&&define.amd?define(function(){return i}):window?window.pickles2Git=i:"undefined"!=typeof e&&e.exports?e.exports=i:console.error("pickles2Git is FAILED to define.")},{}]},{},[1]);